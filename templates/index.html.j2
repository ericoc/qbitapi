{% extends "base.html.j2" %}
{%- block scripts %}
        <link rel="stylesheet" href="https://cdn.datatables.net/2.0.3/css/dataTables.bootstrap5.css">
        <script src="https://cdn.datatables.net/2.0.3/js/dataTables.js"></script>
        <script src="https://cdn.datatables.net/2.0.3/js/dataTables.bootstrap5.js"></script>
        <script src="{{ url_for('static', filename='tbl.js') }}"></script>
{%- endblock scripts %}
{%- block content %}
                <table class="table table-sm table-striped w-100" id="torrentsTable"></table>
                <script id="torrents" type="application/json">{{ torrents | tojson }}</script>
                <script>
                    const torrentData = JSON.parse(document.getElementById("torrents").textContent);
                    torrentData.forEach(buildTorrent);
                    const pageTable = new DataTable(
                        "#torrentsTable", {
                            columns: columns,
                            data: torrents,
                            lengthMenu: [
                                [5, 10, 15, 20, 25, 50, 75, 100, -1],
                                [5, 10, 15, 20, 25, 50, 75, 100, "all"]
                            ],
                            order: [[6, "desc"],],
                            pageLength: 15
                        }
                    );
                    const urlParams = new URLSearchParams(window.location.search);
                    const searchKeyword = urlParams.get('search');
                    if (searchKeyword) {
                        pageTable.search(searchKeyword);
                        pageTable.draw();
                    };
                </script>
{%- endblock content %}
